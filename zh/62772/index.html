<!DOCTYPE html><html lang="zh" class="theme-container"><head><meta charset="utf-8"/><meta name="viewport" content="width=divice-width,initial-scale=1"/><meta name="robots" content="noindex"/><meta name="generator" content="Hugo 0.155.3"/><title>静态博客文章加密工具测试
| 赤赤的象牙塔</title><link rel="stylesheet" type="text/css" href="../../css/base.min.77b5736a81ec178b46cb581d1318f5aee784504170c67bf68d9e3c729b7fff42.css"/><link rel="stylesheet" media="screen and (max-width: 1200px)" type="text/css" href="../../css/small.min.3b39abcf5074cbb0bd712da27c43d1c5f11a85f597da9f07a0d600e53eec7d24.css"/><link rel="stylesheet" media="screen and (min-width: 1201px)" type="text/css" href="../../css/normal.min.ac1ee5c0e20afb15107d14583eece7d76c7fb36009c07be3f3447c299209ca53.css"/><link rel="stylesheet" type="text/css" href="../../css/syntax.min.ed5b37c3a50997d5ccd8b81bf0d00a7ac1f92c82985623c2dbf0cb422596726a.css"/><script src="../../js/ctheme.min.23d42d00e692299bcf2b5832c28a8a1582346c7c45d8bc4f70280fcdbf146872.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6CF2JBMYH3"></script><script>var doNotTrack=!1,dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes";if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CF2JBMYH3")}</script><script data-goatcounter="https://zerovip.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script></head><body><nav class="bar_for_phone"><div class="bar_left_button"><div class="left_button_for_bar" onclick="ChangeClassLeft()"><div class="bar1"></div><div class="bar2"></div><div class="bar3"></div></div></div><div class="bar_search-box" onclick="startSearch(&#34;right&#34;)"><div class="magnifying-glass"></div></div><div class="bar_title"><a href="../../zh/">赤赤的象牙塔</a></div><div class="bar_right_button"><button class="toc_title_for_bar" onclick="ChangeClassTOC()">目录</button></div></nav><div class="body_for_pc"><aside class="left" id="left"><div class="left_non-footer" id="left_non-footer"><div class="left_non-footer_option"><div class="left_non-footer_option_search-icon" onclick="startSearch(&#34;left_non-footer&#34;)"><div class="magnifying-glass"></div></div><div role="checkbox" aria-checked="true" class="left_non-footer_option_theme-switch"><label class="switch"><input type="checkbox" class="theme-switcher" onchange="themeSwitch()"/>
<span class="slider round"></span></label></div><ul role="listbox" class="left_non-footer_option_language"><li role="option" aria-selected="true" class="left_non-footer_option_active">简体中文 ⦿</li><li role="option" aria-selected="false" class="left_non-footer_option_non-active"><a href="../../en/62772/">English ○</a></li><li role="option" class="left_non-footer_option_non-active">Français ⨂</li></ul><div class="left_non-footer_option_rss"><div class="left_non-footer_option_non-active">RSS 订阅 ⊠</div></div></div><header class="left_non-footer_head"><div class="left_non-footer_head_title"><a href="../../zh/">赤赤的象牙塔</a></div><div class="left_non-footer_head_subtitle">(●’◡’●)ﾉ</div></header><nav class="left_non-footer_main"><div class="h1"><a href="../../zh/math/">数学</a></div><div class="h2"><a href="../../zh/math/notes/">数学笔记</a></div><div class="h2"><a href="../../zh/math/stories/">数学科普</a></div><div data-pagefind-filter="1st-section" class="h1 active"><a href="../../zh/non-math/">非数学</a></div><div class="h2"><a href="../../zh/non-math/journal/">日志</a></div><div class="h2"><a href="../../zh/non-math/literature/">写作</a></div><div data-pagefind-filter="2nd-section" class="h2 active"><a href="../../zh/non-math/memos/">备忘</a></div><div class="h1"><a href="../../zh/record/">记录</a></div><div class="h2"><a href="../../zh/record/book/">读过的书</a></div><div class="h2"><a href="../../zh/record/film/">看过的电影</a></div><div class="h1"><a href="../../zh/about/">关于</a></div><div class="h2"><a href="../../zh/about/me/">关于我</a></div><div class="h2"><a href="../../zh/about/site/">关于本站</a></div></nav></div><footer class="left_footer"><div class="copyright">©2019-2026 版权所有.</div></footer></aside><div data-pagefind-body="" class="right" id="right" onclick="HideBothSide()"><header class="right_head"><div data-pagefind-meta="title" class="right_head_title">静态博客文章加密工具测试</div><div data-pagefind-ignore="" class="right_head_des"><span data-pagefind-meta="date">2019年12月23日</span> - 929 字</div></header><div class="right_main"><article class="right_main_article"><h1 id="介绍">介绍
<a href="#%e4%bb%8b%e7%bb%8d"><small data-pagefind-ignore="">¶</small></a></h1><p><a href="https://github.com/Li4n0/hugo_encryptor" target="_blank" rel="noreferrer noopener">Hugo encryptor<b><sub data-pagefind-ignore="">⧉</sub></b></a> 是一款我偶然发现的可以给静态博客文章进行加密的小工具，配置使用很简单，可惜的是不能在本地测试.</p><p>不过它足够简单，一经测试成功可以投入使用便不再需要反复测试，因此这篇博文是专门用来测试的.</p><p>下面加密内容的密码是【PASS3word】. 这部分内容在 RSS 中没有被加密，在<a href="../../zh/non-math/memos/index.xml">“备忘分区”的 RSS</a> 中可以找到加密的内容.</p><div role="note" class="notation_color"><p>由于那个 python 的工具在 python 升级之后还要重新设置 venv 什么的，我嫌麻烦，于是找到类似的用 go 语言写的<a href="https://github.com/Izumiko/hugo-encrypt" target="_blank" rel="noreferrer noopener">加密工具<b><sub data-pagefind-ignore="">⧉</sub></b></a>. 原理都是一样的，但这个工具的好处是：编译成二进制文件，随时都能使用；不需要那个奇怪的 <code>&lt;!-- more --&gt;</code> 写摘要了；提示文字可以通过 i18n 变量写成各种语言了；有了默认密码，我暂时设置为了“qwertyu”.</p><p>最后两项功能在<a href="../../en/62772/">英文页面</a>进行测试.</p></div><hugo-encrypt data-pagefind-ignore=""><div id="hugo-encrypt-encryption-notice"><p>以下内容被密码保护.</p><noscript><span id=hugo-encrypt-enable-js>Javascript needs to be enabled to decrypt content</span></noscript><div class="hugo-encrypt-form"><input class="hugo-encrypt-input" id="hugo-encrypt-password" placeholder="请输入密码."/>
<input class="hugo-encrypt-button" type="button" value="提交" id="button" onclick="hugoDecrypt(document.getElementById(&#34;hugo-encrypt-password&#34;).value,&#34;input&#34;)"/><div id="hugo-encrypt-input-response"></div></div></div><cipher-text style="display:none;">c84476be2faffed9-7ea8f86c8716fb87937f8490-89675fbde149c43622016d8c3cad5593656fd29e1891bdce0b90acb4dbba9cad71fb6f0dbfc09b93f28894f1ae40390b51b49c6eb3a56f80cc9891f5ad207121edf0d61db0e7beacbe7f0095b135b0af4b47d88da0bbbe373f97934becb178096634300c626b935d5dfe283aba87e7afe9edbb4fe60a02d62b608ac70c142b42844f55dca238db5a551a34edba8774d9faef2e80cbf7e849b5c5bb5ef2134c09da238eef42ffcdd70adfe906a912df98ba2cc778819a10c7a3b058cae65d3ad9052865a775617ecc2011f2b36f961e71438e05430b159194ef48ffbe4e188c46b5c90626607df447212fc92d720422ec721f1a64288308c121c4aca34b1112a22e0446f1308b411b84a63d9b0a813eeeda46bb061a127c34f458df001b6ea096ce16fd6f149535dac73acb050587b648efe8e8c663317a2097f72c9c312e69c49c3e354baca53b5a3a4283af9e9088f480f88c43bc90398953440dbfbef761d98d4b62d7c24d79d711a3eedfa2cb4ad92c14994ee8010d39c1271caace56ee99cc57f83e863cb070879d1c6a999eb7a2694f3de397692acd93ee17471d0a2c24c111d20d4b8c9c96cfea82719dc00c28784d21210e802a23ad4df0df682c19d3fe0ba15dde8e4ade209b24fd4ba7048d25b56286547c61c4e9a24885bcbd5be35f9ccb4bf67c0fcae80b687f1ac53b4714e5058f2c6039f51a2858ba66ad47a433a1be5a3908d412a5cf2a0fcce69e2480cfb5cff5afd79351dfa2e83308bcf1b82af412dc37a471d24da53d7cfdaabe47db3493744e30bebd8ccc94f5bb25a71c69b4ff88ff0c9f464648546d9d60dbab2bf804d3a18ab73674eb53625fc42ef0fba09373e7173c702c76dbfd7fb8f79cc1848ed9bf8d655f4b3206a69825eccc5cbc07bffbdb4d5ac0533e2f770f2bfcd5d53ad60ddaf0412a9065c2ff26c2419cadae77d4bb9df6d6ee66e5c7b6cdebb8da69a012cbc3240176f91cba390a689e129b60f598c53999f61148db77a934aa62a100d6c0c838363f73ff460b2c1a4196e56ea48112d562f2238e9fc5690eae9724c54395838a58216974ef38e536937630857c52c904cb3f256ec05ba8da76c81f6aebbe49d5474e7c1c3f40191c8118a3bb5636535f63c03bb57666f7a474df1fa8f2b937faaf8f5a57ea867bcc9982a3fbba1969584fa3e9d3ee5f736cd34af99b02ae78bb237dec53a843a71d9ea4b1ee264c1ec4a091f1217cf7118c7e7bce6acca91d1536b7d2a9f19ad2ea1905db0ac6fe0768304d4b21879a56d6cd34868ebf464f556372579a785fb315c46fe367f5dd3c2cc7c7818253550b78bccdf865b7472dffc5fdaa2647cb6c74517a9d4bdb18acff2caa7470b865f93f901d78576c5547ac74850cc2a9c1e8136b95b1b8c9f027331547e378743731109995e771df12801d22354efd0370f91ab0b93a003a018ecd08e66911357458734a17ed91674d6415280c3a41f3e93bd93e714c457e0df4429351abf156fbfb2d7fbfca966ce28c164bf1b3447f4b6006d58542f942983ec105146b839f7fcd4104cdb4638513359543e0265d2883cab2a2fdb56d50d0a5a8e7b74e30a35ea4fea8766c12426756ad09db78f02069bc7600ddd4383bb0201e0dd3ac1be9de28adf008675126ea89cc112c643c58a4fb5fbe6c1863acd9aa72b65310b5d16baf1192c18b13bc65b5289cc3db8ae99c508f6f0f63bdfcf558f6084b7fe2d6c356ac562708f262bcc4b48b6891b248ef351a7672f8fdc30b064beaab646b401a00c524a8bfbcaf231960fa9af46b2a160439ba83e4c2462d4dcc62f8d1ae965093e35d2bddd6e8158c5f9ee938eb7642a6ad62f9d6c2ab06b32aa286bfd035db646f511539e6105fee61ca826ca4b06c71174c998c787ea18965abac67e7ceefde8793cbb407129a05cf114a6c6dbb092088ef3b5e9acf923186bf11e11914220856183255604762bbf7b9bab34c16713017d6cf7332832525c6e9745a4696ebed1669f0c06b15b793b38e44d14f419cff434d8c7d6757de7e3ec19d6b9dc7bc46237db5aac07460b9f8d98c69af32c70e87833ecb5542ddeace39cd7f3e01d981caf7128c14c4821e9f869ca533a60a6e7485cb58a0d4e897a30a33d4d8a06f4ebb202c2b453d245ccffa52eeec736e75666366144b881b516490f5bb38c215fece3117fcafa68c1ecf3ce4a0893348453075e4b8b64f43ee3588d3ec45bc04989eec9f4e9d19f1c5c688c5d13b67e2af12b9504e902a59efda7c91aff8ceb695702feaa619d7b8a17114dc6cd5885f5b2956a5a5ecf89c07594cdc4574a0e0fd411853583f23017275bffcef554fe304f1392b4831c3100de4de3b9febf3c2c4915a57be</cipher-text><style type="text/css">div#hugo-encrypt-sha1sum{display:none}</style><script>const storageKey=location.pathname+"password",userStorage=window.sessionStorage;function str2buf(e){return new TextEncoder("utf-8").encode(e)}function buf2str(e){return new TextDecoder("utf-8").decode(e)}function hex2buf(e){return new Uint8Array(e.match(/.{2}/g).map(e=>parseInt(e,16)))}function deriveKey(e,t){return t=t||crypto.getRandomValues(new Uint8Array(8)),crypto.subtle.importKey("raw",str2buf(e),"PBKDF2",!1,["deriveKey"]).then(e=>crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e3,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])).then(e=>[e,t])}function decrypt(e,t){const[n,s,o]=t.split("-").map(hex2buf);return deriveKey(e,n).then(([e])=>crypto.subtle.decrypt({name:"AES-GCM",iv:s},e,o)).then(e=>buf2str(new Uint8Array(e)))}async function digestMessage(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-1",t),s=Array.from(new Uint8Array(n)),o=s.map(e=>e.toString(16).padStart(2,"0")).join("");return o}const hugoDecrypt=function(e,t){for(const n of ciphers)decrypt(e,n.innerText).then(function(t){digestMessage(t.replace(/\r?\n?[^\r\n]*$/,"")).then(function(s){t.includes(s)&&(document.getElementById("hugo-encrypt-encryption-notice").remove(),n.outerHTML=t,userStorage.setItem(storageKey,e),document.getElementById("hugo-encrypt-sha1sum").innerHTML="Success: "+s,console.log("Decryption successful. Storing password in sessionStorage."))})}).catch(function(e){t==="input"?(document.getElementById("hugo-encrypt-input-response").innerHTML="密码错误！",console.log("密码错误！",e)):t==="storage"&&(userStorage.removeItem(location.pathname+"password"),console.log("Password changed. Clearing userStorage.",e))})}</script><script>window.onload=()=>{ciphers=Array.from(document.querySelectorAll("cipher-text")),userStorage.getItem(storageKey)&&(console.log("Found storageKey in userStorage. Attemtping decryption"),hugoDecrypt(userStorage.getItem(storageKey),"storage"))}</script></hugo-encrypt><h2 id="未被加密的标题">未被加密的标题
<a href="#%e6%9c%aa%e8%a2%ab%e5%8a%a0%e5%af%86%e7%9a%84%e6%a0%87%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h2><p>在解密前这里的序号是1.1，解密后这里的序号是3.4.</p><h1 id="未被加密的一级标题">未被加密的一级标题
<a href="#%e6%9c%aa%e8%a2%ab%e5%8a%a0%e5%af%86%e7%9a%84%e4%b8%80%e7%ba%a7%e6%a0%87%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h1><p>在解密前这里的序号是2，解密后这里的序号是4.</p><h2 id="未解决的问题">未解决的问题
<a href="#%e6%9c%aa%e8%a7%a3%e5%86%b3%e7%9a%84%e9%97%ae%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h2><ol><li>目录会出现问题. 可能是 css 标签被改了的原因，具体没有仔细看，也不着急解决这个问题.</li><li>本地测试时把加密内容直接隐藏了，以至于只能先把文章写完再进行加密操作. 有个解决思路是用 <code>{{ if not .Site.IsServer }} {{ end }}</code> 在 <code>layouts/shortcodes/hugo-encryptor.html</code> 里做一下限制，不过试了一下不太会写，留待以后愿意解决再解决吧.</li><li><del>那个 <code>&lt;!-- more --&gt;</code> 的标签导致它上面的内容成为了 summary，而 front matter 里的 summary 不再起作用. 这倒不是什么大问题.</del></li><li>如果有两段加密内容的话，页面里有些 js 可能会重复，可以考虑精简精简. 还有就是“密码错误”的弹出位置可能不对，输入第二个密码却弹在第一个.（见英文页面）</li><li>阅读并理解代码，确定它的可靠性.（做那个 sha 之类的.）确定它没有从网络上获取什么 js.</li><li>弄得好看一点？</li></ol><p></p><p></p><p></p><p></p></article></div><div data-pagefind-ignore="" class="right_comments"><script src="https://utteranc.es/client.js" repo="zerovip/bcsu" issue-term="pathname" theme="github-light" crossorigin="anonymous" async=""></script></div></div><aside data-pagefind-ignore="" class="toc" id="toc"><button class="toc_title">目录</button><div class="toc_content"><nav id="TableOfContents"><ul><li><a href="#介绍">介绍</a><ul><li><a href="#未被加密的标题">未被加密的标题</a></li></ul></li><li><a href="#未被加密的一级标题">未被加密的一级标题</a><ul><li><a href="#未解决的问题">未解决的问题</a></li></ul></li></ul></nav></div></aside></div><template id="search-zone-template"><div id="search-zone"><div class="search_bar"><input type="search" id="search-input-box" class="search_bar_search-box" placeholder="搜索……" autocomplete="off"/><div class="search_bar_close-sign" onclick="closeSearch(this)"><div class="close-sign"></div></div></div><div class="search_results"></div></div></template><template id="search-result"><div class="search_results_item"><div class="search_results_item_title"></div><div class="search_results_item_content"></div><div class="search_results_item_tags"><div class="search_results_item_tags_date"></div><div class="search_results_item_tags_sections"></div></div></div></template><script src="../../js/main.07644855453ea3563fc25b36d91f32b4aa952cd60ebafb6fad77cf9c74baea47.js"></script></body></html>