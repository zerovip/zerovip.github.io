<!DOCTYPE html><html lang="zh" class="theme-container"><head><meta charset="utf-8"/><meta name="viewport" content="width=divice-width,initial-scale=1"/><meta name="robots" content="noindex"/><meta name="generator" content="Hugo 0.139.5"/><title>静态博客文章加密工具测试
| 赤赤的象牙塔
</title><link rel="stylesheet" type="text/css" href="../../css/base.min.77b5736a81ec178b46cb581d1318f5aee784504170c67bf68d9e3c729b7fff42.css"/><link rel="stylesheet" media="screen and (max-width: 1200px)" type="text/css" href="../../css/small.min.3b39abcf5074cbb0bd712da27c43d1c5f11a85f597da9f07a0d600e53eec7d24.css"/><link rel="stylesheet" media="screen and (min-width: 1201px)" type="text/css" href="../../css/normal.min.ac1ee5c0e20afb15107d14583eece7d76c7fb36009c07be3f3447c299209ca53.css"/><link rel="stylesheet" type="text/css" href="../../css/syntax.min.ed5b37c3a50997d5ccd8b81bf0d00a7ac1f92c82985623c2dbf0cb422596726a.css"/><script src="../../js/ctheme.min.23d42d00e692299bcf2b5832c28a8a1582346c7c45d8bc4f70280fcdbf146872.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6CF2JBMYH3"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CF2JBMYH3")}</script><script data-goatcounter="https://zerovip.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script></head><body><nav class="bar_for_phone"><div class="bar_left_button"><div class="left_button_for_bar" onclick="ChangeClassLeft()"><div class="bar1"></div><div class="bar2"></div><div class="bar3"></div></div></div><div class="bar_search-box" onclick="startSearch(&#34;right&#34;)"><div class="magnifying-glass"></div></div><div class="bar_title"><a href="../../zh/">赤赤的象牙塔</a></div><div class="bar_right_button"><button class="toc_title_for_bar" onclick="ChangeClassTOC()">目录</button></div></nav><div class="body_for_pc"><aside class="left" id="left"><div class="left_non-footer" id="left_non-footer"><div class="left_non-footer_option"><div class="left_non-footer_option_search-icon" onclick="startSearch(&#34;left_non-footer&#34;)"><div class="magnifying-glass"></div></div><div role="checkbox" aria-checked="true" class="left_non-footer_option_theme-switch"><label class="switch"><input type="checkbox" class="theme-switcher" onchange="themeSwitch()"/>
<span class="slider round"></span></label></div><ul role="listbox" class="left_non-footer_option_language"><li role="option" aria-selected="true" class="left_non-footer_option_active">简体中文 ⦿</li><li role="option" aria-selected="false" class="left_non-footer_option_non-active"><a href="../../en/62772/">English ○</a></li><li role="option" class="left_non-footer_option_non-active">Français ⨂</li></ul><div class="left_non-footer_option_rss"><div class="left_non-footer_option_non-active">RSS 订阅 ⊠</div></div></div><header class="left_non-footer_head"><div class="left_non-footer_head_title"><a href="../../zh/">赤赤的象牙塔</a></div><div class="left_non-footer_head_subtitle">(●’◡’●)ﾉ</div></header><nav class="left_non-footer_main"><div class="h1"><a href="../../zh/math/">数学</a></div><div class="h2"><a href="../../zh/math/notes/">数学笔记</a></div><div class="h2"><a href="../../zh/math/stories/">数学科普</a></div><div data-pagefind-filter="1st-section" class="h1 active"><a href="../../zh/non-math/">非数学</a></div><div class="h2"><a href="../../zh/non-math/journal/">日志</a></div><div class="h2"><a href="../../zh/non-math/literature/">写作</a></div><div data-pagefind-filter="2nd-section" class="h2 active"><a href="../../zh/non-math/memos/">备忘</a></div><div class="h1"><a href="../../zh/record/">记录</a></div><div class="h2"><a href="../../zh/record/book/">读过的书</a></div><div class="h2"><a href="../../zh/record/film/">看过的电影</a></div><div class="h1"><a href="../../zh/about/">关于</a></div><div class="h2"><a href="../../zh/about/me/">关于我</a></div><div class="h2"><a href="../../zh/about/site/">关于本站</a></div></nav></div><footer class="left_footer"><div class="copyright">©2019-2024 版权所有.</div></footer></aside><div data-pagefind-body="" class="right" id="right" onclick="HideBothSide()"><header class="right_head"><div data-pagefind-meta="title" class="right_head_title">静态博客文章加密工具测试</div><div data-pagefind-ignore="" class="right_head_des"><span data-pagefind-meta="date">2019年12月23日</span> - 929 字</div></header><div class="right_main"><article class="right_main_article"><h1 id="介绍">介绍
<a href="#%e4%bb%8b%e7%bb%8d"><small data-pagefind-ignore="">¶</small></a></h1><p><a href="https://github.com/Li4n0/hugo_encryptor" target="_blank" rel="noreferrer noopener">Hugo encryptor<b><sub data-pagefind-ignore="">⧉</sub></b></a> 是一款我偶然发现的可以给静态博客文章进行加密的小工具，配置使用很简单，可惜的是不能在本地测试.</p><p>不过它足够简单，一经测试成功可以投入使用便不再需要反复测试，因此这篇博文是专门用来测试的.</p><p>下面加密内容的密码是【PASS3word】. 这部分内容在 RSS 中没有被加密，在<a href="../../zh/non-math/memos/index.xml">“备忘分区”的 RSS</a> 中可以找到加密的内容.</p><div role="note" class="notation_color"><p>由于那个 python 的工具在 python 升级之后还要重新设置 venv 什么的，我嫌麻烦，于是找到类似的用 go 语言写的<a href="https://github.com/Izumiko/hugo-encrypt" target="_blank" rel="noreferrer noopener">加密工具<b><sub data-pagefind-ignore="">⧉</sub></b></a>. 原理都是一样的，但这个工具的好处是：编译成二进制文件，随时都能使用；不需要那个奇怪的 <code>&lt;!-- more --&gt;</code> 写摘要了；提示文字可以通过 i18n 变量写成各种语言了；有了默认密码，我暂时设置为了“qwertyu”.</p><p>最后两项功能在<a href="../../en/62772/">英文页面</a>进行测试.</p></div><hugo-encrypt data-pagefind-ignore=""><div id="hugo-encrypt-encryption-notice"><p>以下内容被密码保护.</p><noscript><span id=hugo-encrypt-enable-js>Javascript needs to be enabled to decrypt content</span></noscript><div class="hugo-encrypt-form"><input class="hugo-encrypt-input" id="hugo-encrypt-password" placeholder="请输入密码."/>
<input class="hugo-encrypt-button" type="button" value="提交" id="button" onclick="hugoDecrypt(document.getElementById(&#34;hugo-encrypt-password&#34;).value,&#34;input&#34;)"/><div id="hugo-encrypt-input-response"></div></div></div><cipher-text style="display:none;">01591c39ad8e05f4-1aa8aec7045006ae4cb9923c-74d0dfc5c32c65807a118d236ff2417bbe1777c462fe5ce3c4abebccdf4d6c66e8029188a9d3d6a22bb5e88c37b50ac7c4b4052458e99d03cea9cd305237cf639031fa01cd603fcba87672df85a8676b30e011a87f3ab6b0aba0ea851b9c51a126aedcba46a7208dbc771362e43f2c6770cec3c9239a273d13bcfa0c6c1fcdc150119cdb431c7f4083d2dde1d6f4556d05c4edba83596a54e97d7359e672143c356eaf9fae1f00c666ede4acee627331026f68c0cda6542aff1112978c194e38290648067a1b3f6dd9a30d2f57512f1be53ad74c006cec08e51ad053179807159d86a82f144a27f8bf2e75354faaf42936820483916d166845d9cdc381f639fce7c3c503d5ef8f8b53c40ba27e6d436eb1ec61d64dffc831203bc66f9a4b48b9621c93cf3fa504514f13bfba18a1487f8bd80a3c0bb2612906182782de5a14f9c0f53714e294fffb14f70c5449f8ede81d40f2f8ec17ab8cec63f17540dadd64dae24c461b22ef82f9b6e4692488fed903e68de105b05eb1734c321b82b27cc851bc3a36731d782095990ed9396a01893a688768e9222af0654a45d26ceb6b3888ad5c93f1aca15f5bae71d73e0a8f21941e8672b02ae8c8882bf5ac8bc14b3a01030f29a1fadfa18fc14812ec4a541e44919e9fd47d21a4f6181c647309dc94e4ece7851db04f77cf304e5ee45d0d939ace6363cfa787d7b492bae16dded4c6d4d7536117fa04dce4cb8ea6844d002df5b70c7956bcc155018d7ba5703dcbc27f6bab6e15aeb2bf9a021bdb2682f24ecef1de81d69323325199a60b721f31ae2bef5ea9067157918170fd2863e9f8febf283e130cd309b734758dbb016530ea1b2536c6b3e59b09be3d20c0388bc4517317ac99e1fa585a502886942e76e03ad4d98c59773a25eee00aca4b4c23c085fa24f91d45cd874341dbd1058ee0836ad535d7e4b675125a5d0476a47b45c82b490a828b9ea4801d153a654a0ca96c7aa58989c18210a3631bc35cb1d3593f376e74e3ca0c1f9ce8cfc5ff32bc21cf8c58610d1bb2e8fc3a9e2cfd7a89649fd961d11266a1378eedf799f5b681cacc277cec0ee8ff8fb39d2f757305cc3b2e365baeaa358f436d90d87585563c9b536247b4adc884a4d596de1fe25bac4d833589a82b264bf6e0d6740ad148f43f61ff8e61da8de5d25a05828ac9259c87ed34b8991332ff9105eade519d3ff5cea98852396d1b5375412bba1ffa69f01500d58b3ad60df89a722ed2837e96115c82f6b1eeab8f20d12779edfa5daa2c8047a9da4e9d13896b46acb3b15599846b45170851fa57487a3f05f701b01d577dfaded4f16eb1081a74c4f3278c5457732d0b96e14bf2013ccb27bdc0492fa1892cd0d4085de67fef9e8a423b9af64ad2d697fcf233533c841462830633e4e1646551b5674c3993c10490ccf59e913c76ac1dfd00a88de5d9e9def7c454954792cb8a8d08b6eff342f5f0d361607c4f2df21745917b6a8dfe1f374a3c3c126caa6a7266d55398a8345cb2f546c466ead104f429070112b359a484c7389fa82c476e3ec56f52c5076269d67d74a8d5e04c47d53ce0c7753410020d9b766dc65411fdef6b0ec44ade157a5e70a0c01e4d558f743c3024656a919fb77eb9c2266da58f9576e55753ee6c1f77f86613dfe1de914c68e1fd8153661ba9c624df886a533fa8fb4f14a1d3af60b17878d8774689b27cbc9aa7fa4782486149a7b5b041c2ab6db5cbf877b461f43b91dfb6fa09168846c9ec741ce4dec87d33a43d05b610324356c48266958019dd5f430f41694d90a5f0f5eaaba47fc6b865693e15b9e9304dcda101a47f21c639ce9befd8a06d1fcc8e5051e4d90fb4203dd1d6e6784a5a25286152595e4b9ddab159a1dea7dfb3cd82341f75f23cf1ad0df4a78a2f5291f6d91e52cb8a0e192711b7b05e0c67c96970d2c2de74e3c2a25acccee125b8d493a2fd983e0d932ac324e8814bdc4d226eb35f6de2e47e86463eb290ffe19d2d9d42730b2dcbebd644449f53b437a6a196fced3c8b64af0d0b55ee124a236133ed8942cd3f69dc9094165db94dad7ec2554da58b0fbb4e6fe9d4ea7c1d48edb4dfe9b21f10621e21adcbb7581981972c8be84b60d1e271feea2fb47b6b2fc5fc991f636c4dac614136c7653ae8638786be63274362c0ad097cb1ed2213c691d7e54a6bf56cd6601d6172bc78ec198daeb545c45abfa96832d3325d28e37ecb886ffeae6fd75ed8f004b2a03822bb4084b5dfc406ba468d072bef304832ca3f0a2725e58bff24d3263cc5f649af259b56b61d4b8b2af1d69842dc60d998a3121aa937fe4d08ca83ef19edde17f8c15bbaa6d285b7aa8afe6cbeddef5633188c4bac9421f56b</cipher-text><style type="text/css">div#hugo-encrypt-sha1sum{display:none}</style><script>const storageKey=location.pathname+"password",userStorage=window.sessionStorage;function str2buf(e){return new TextEncoder("utf-8").encode(e)}function buf2str(e){return new TextDecoder("utf-8").decode(e)}function hex2buf(e){return new Uint8Array(e.match(/.{2}/g).map(e=>parseInt(e,16)))}function deriveKey(e,t){return t=t||crypto.getRandomValues(new Uint8Array(8)),crypto.subtle.importKey("raw",str2buf(e),"PBKDF2",!1,["deriveKey"]).then(e=>crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e3,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])).then(e=>[e,t])}function decrypt(e,t){const[n,s,o]=t.split("-").map(hex2buf);return deriveKey(e,n).then(([e])=>crypto.subtle.decrypt({name:"AES-GCM",iv:s},e,o)).then(e=>buf2str(new Uint8Array(e)))}async function digestMessage(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-1",t),s=Array.from(new Uint8Array(n)),o=s.map(e=>e.toString(16).padStart(2,"0")).join("");return o}const hugoDecrypt=function(e,t){for(const n of ciphers)decrypt(e,n.innerText).then(function(t){digestMessage(t.replace(/\r?\n?[^\r\n]*$/,"")).then(function(s){t.includes(s)&&(document.getElementById("hugo-encrypt-encryption-notice").remove(),n.outerHTML=t,userStorage.setItem(storageKey,e),document.getElementById("hugo-encrypt-sha1sum").innerHTML="Success: "+s,console.log("Decryption successful. Storing password in sessionStorage."))})}).catch(function(e){t==="input"?(document.getElementById("hugo-encrypt-input-response").innerHTML="密码错误！",console.log("密码错误！",e)):t==="storage"&&(userStorage.removeItem(location.pathname+"password"),console.log("Password changed. Clearing userStorage.",e))})}</script><script>window.onload=()=>{ciphers=Array.from(document.querySelectorAll("cipher-text")),userStorage.getItem(storageKey)&&(console.log("Found storageKey in userStorage. Attemtping decryption"),hugoDecrypt(userStorage.getItem(storageKey),"storage"))}</script></hugo-encrypt><h2 id="未被加密的标题">未被加密的标题
<a href="#%e6%9c%aa%e8%a2%ab%e5%8a%a0%e5%af%86%e7%9a%84%e6%a0%87%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h2><p>在解密前这里的序号是1.1，解密后这里的序号是3.4.</p><h1 id="未被加密的一级标题">未被加密的一级标题
<a href="#%e6%9c%aa%e8%a2%ab%e5%8a%a0%e5%af%86%e7%9a%84%e4%b8%80%e7%ba%a7%e6%a0%87%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h1><p>在解密前这里的序号是2，解密后这里的序号是4.</p><h2 id="未解决的问题">未解决的问题
<a href="#%e6%9c%aa%e8%a7%a3%e5%86%b3%e7%9a%84%e9%97%ae%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h2><ol><li>目录会出现问题. 可能是 css 标签被改了的原因，具体没有仔细看，也不着急解决这个问题.</li><li>本地测试时把加密内容直接隐藏了，以至于只能先把文章写完再进行加密操作. 有个解决思路是用 <code>{{ if not .Site.IsServer }} {{ end }}</code> 在 <code>layouts/shortcodes/hugo-encryptor.html</code> 里做一下限制，不过试了一下不太会写，留待以后愿意解决再解决吧.</li><li><del>那个 <code>&lt;!-- more --&gt;</code> 的标签导致它上面的内容成为了 summary，而 front matter 里的 summary 不再起作用. 这倒不是什么大问题.</del></li><li>如果有两段加密内容的话，页面里有些 js 可能会重复，可以考虑精简精简. 还有就是“密码错误”的弹出位置可能不对，输入第二个密码却弹在第一个.（见英文页面）</li><li>阅读并理解代码，确定它的可靠性.（做那个 sha 之类的.）确定它没有从网络上获取什么 js.</li><li>弄得好看一点？</li></ol><p></p><p></p><p></p><p></p></article></div><div data-pagefind-ignore="" class="right_comments"><script src="https://utteranc.es/client.js" repo="zerovip/bcsu" issue-term="pathname" theme="github-light" crossorigin="anonymous" async=""></script></div></div><aside data-pagefind-ignore="" class="toc" id="toc"><button class="toc_title">目录</button><div class="toc_content"><nav id="TableOfContents"><ul><li><a href="#介绍">介绍</a><ul><li><a href="#未被加密的标题">未被加密的标题</a></li></ul></li><li><a href="#未被加密的一级标题">未被加密的一级标题</a><ul><li><a href="#未解决的问题">未解决的问题</a></li></ul></li></ul></nav></div></aside></div><template id="search-zone-template"><div id="search-zone"><div class="search_bar"><input type="search" id="search-input-box" class="search_bar_search-box" placeholder="搜索……" autocomplete="off"/><div class="search_bar_close-sign" onclick="closeSearch(this)"><div class="close-sign"></div></div></div><div class="search_results"></div></div></template><template id="search-result"><div class="search_results_item"><div class="search_results_item_title"></div><div class="search_results_item_content"></div><div class="search_results_item_tags"><div class="search_results_item_tags_date"></div><div class="search_results_item_tags_sections"></div></div></div></template><script src="../../js/main.07644855453ea3563fc25b36d91f32b4aa952cd60ebafb6fad77cf9c74baea47.js"></script></body></html>