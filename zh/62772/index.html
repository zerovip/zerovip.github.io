<!DOCTYPE html><html lang="zh" class="theme-container"><head><meta charset="utf-8"/><meta name="viewport" content="width=divice-width,initial-scale=1"/><meta name="robots" content="noindex"/><meta name="generator" content="Hugo 0.111.3"/><title>静态博客文章加密工具测试
| 赤赤的象牙塔</title><link rel="stylesheet" type="text/css" href="../../css/base.min.77b5736a81ec178b46cb581d1318f5aee784504170c67bf68d9e3c729b7fff42.css"/><link rel="stylesheet" media="screen and (max-width: 1200px)" type="text/css" href="../../css/small.min.3b39abcf5074cbb0bd712da27c43d1c5f11a85f597da9f07a0d600e53eec7d24.css"/><link rel="stylesheet" media="screen and (min-width: 1201px)" type="text/css" href="../../css/normal.min.ac1ee5c0e20afb15107d14583eece7d76c7fb36009c07be3f3447c299209ca53.css"/><link rel="stylesheet" type="text/css" href="../../css/syntax.min.ed5b37c3a50997d5ccd8b81bf0d00a7ac1f92c82985623c2dbf0cb422596726a.css"/><script src="../../js/ctheme.min.23d42d00e692299bcf2b5832c28a8a1582346c7c45d8bc4f70280fcdbf146872.js"></script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-6CF2JBMYH3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-6CF2JBMYH3",{anonymize_ip:!1})}</script><script data-goatcounter="https://zerovip.goatcounter.com/count" async="" src="//gc.zgo.at/count.js"></script></head><body><nav class="bar_for_phone"><div class="bar_left_button"><div class="left_button_for_bar" onclick="ChangeClassLeft()"><div class="bar1"></div><div class="bar2"></div><div class="bar3"></div></div></div><div class="bar_search-box" onclick="startSearch(&#34;right&#34;)"><div class="magnifying-glass"></div></div><div class="bar_title"><a href="../../zh/">赤赤的象牙塔</a></div><div class="bar_right_button"><button class="toc_title_for_bar" onclick="ChangeClassTOC()">目录</button></div></nav><div class="body_for_pc"><aside class="left" id="left"><div class="left_non-footer" id="left_non-footer"><div class="left_non-footer_option"><div class="left_non-footer_option_search-icon" onclick="startSearch(&#34;left_non-footer&#34;)"><div class="magnifying-glass"></div></div><div role="checkbox" aria-checked="true" class="left_non-footer_option_theme-switch"><label class="switch"><input type="checkbox" class="theme-switcher" onchange="themeSwitch()"/>
<span class="slider round"></span></label></div><ul role="listbox" class="left_non-footer_option_language"><li role="option" aria-selected="true" class="left_non-footer_option_active">简体中文 ⦿</li><li role="option" aria-selected="false" class="left_non-footer_option_non-active"><a href="../../en/62772/">English ○</a></li><li role="option" class="left_non-footer_option_non-active">Français ⨂</li></ul><div class="left_non-footer_option_rss"><div class="left_non-footer_option_non-active">RSS 订阅 ⊠</div></div></div><header class="left_non-footer_head"><div class="left_non-footer_head_title"><a href="../../zh/">赤赤的象牙塔</a></div><div class="left_non-footer_head_subtitle">(●’◡’●)ﾉ</div></header><nav class="left_non-footer_main"><div class="h1"><a href="../../zh/math/">数学</a></div><div class="h2"><a href="../../zh/math/notes/">数学笔记</a></div><div class="h2"><a href="../../zh/math/stories/">数学科普</a></div><div data-pagefind-filter="1st-section" class="h1 active"><a href="../../zh/non-math/">非数学</a></div><div class="h2"><a href="../../zh/non-math/journal/">日志</a></div><div class="h2"><a href="../../zh/non-math/literature/">写作</a></div><div data-pagefind-filter="2nd-section" class="h2 active"><a href="../../zh/non-math/memos/">备忘</a></div><div class="h1"><a href="../../zh/record/">记录</a></div><div class="h2"><a href="../../zh/record/book/">读过的书</a></div><div class="h2"><a href="../../zh/record/film/">看过的电影</a></div><div class="h1"><a href="../../zh/about/">关于</a></div><div class="h2"><a href="../../zh/about/me/">关于我</a></div><div class="h2"><a href="../../zh/about/site/">关于本站</a></div></nav></div><footer class="left_footer"><div class="copyright">©2019-2023 版权所有.</div></footer></aside><div data-pagefind-body="" class="right" id="right" onclick="HideBothSide()"><header class="right_head"><div data-pagefind-meta="title" class="right_head_title">静态博客文章加密工具测试</div><div data-pagefind-ignore="" class="right_head_des"><span data-pagefind-meta="date">2019年12月23日</span> - 929 字</div></header><div class="right_main"><article class="right_main_article"><h1 id="介绍">介绍
<a href="#%e4%bb%8b%e7%bb%8d"><small data-pagefind-ignore="">¶</small></a></h1><p><a href="https://github.com/Li4n0/hugo_encryptor" target="_blank" rel="noreferrer noopener">Hugo encryptor<b><sub data-pagefind-ignore="">⧉</sub></b></a> 是一款我偶然发现的可以给静态博客文章进行加密的小工具，配置使用很简单，可惜的是不能在本地测试.</p><p>不过它足够简单，一经测试成功可以投入使用便不再需要反复测试，因此这篇博文是专门用来测试的.</p><p>下面加密内容的密码是【PASS3word】. 这部分内容在 RSS 中没有被加密，在<a href="../../zh/non-math/memos/index.xml">“备忘分区”的 RSS</a> 中可以找到加密的内容.</p><div role="note" class="notation_color"><p>由于那个 python 的工具在 python 升级之后还要重新设置 venv 什么的，我嫌麻烦，于是找到类似的用 go 语言写的<a href="https://github.com/Izumiko/hugo-encrypt" target="_blank" rel="noreferrer noopener">加密工具<b><sub data-pagefind-ignore="">⧉</sub></b></a>. 原理都是一样的，但这个工具的好处是：编译成二进制文件，随时都能使用；不需要那个奇怪的 <code>&lt;!-- more --&gt;</code> 写摘要了；提示文字可以通过 i18n 变量写成各种语言了；有了默认密码，我暂时设置为了“qwertyu”.</p><p>最后两项功能在<a href="../../en/62772/">英文页面</a>进行测试.</p></div><hugo-encrypt data-pagefind-ignore=""><div id="hugo-encrypt-encryption-notice"><p>以下内容被密码保护.</p><noscript><span id=hugo-encrypt-enable-js>Javascript needs to be enabled to decrypt content</span></noscript><div class="hugo-encrypt-form"><input class="hugo-encrypt-input" id="hugo-encrypt-password" placeholder="请输入密码."/>
<input class="hugo-encrypt-button" type="button" value="提交" id="button" onclick="hugoDecrypt(document.getElementById(&#34;hugo-encrypt-password&#34;).value,&#34;input&#34;)"/><div id="hugo-encrypt-input-response"></div></div></div><cipher-text style="display:none;">3ccbb521126e83fa-30e8bca7e0f36ef24d218eb9-43c25eaab58c235ad7b2c376ceca4d221386b4de7d849294e787571f4eb3a687358fe56739cd829d094ec7b8701e21cae22cc197df9e6b8b50a41f8f3fc9b2719e4be2ded83ae136eed33ac1a2a0ec13e185437f1818a2c935f62aead20deeae155427dcdd548260aae388b81d3911604b2b05a5a49bb2cf8d640c26711c13b733e7dfa56f7920dd35227b3cbd3cb84556301e4d5dd742a5865af5c2d996757e8d904fa5d0eeabbf2b9f37ddc57ed67b1dcce7a954e5762d92cc48757d3f2700ea020626f781f7045411d430943dd1c64b0649217a1a25894920e9452a0a7e8660d47d09c19d2bc52b4ab2e1c05957d7e3f3509d508cc5aa08a02d0776ca04223779b12e4d8bf6849defcc9900fd1a38f4e50af787d86714701b2dfe21a22ef5159e43c0dd7bac4608b0ea46db98c0d32a10d1cf18c189fc4e905ef7b94cf3f7c8d4e70943406168f6d8f9120e7d2014bb3f10f2f1fd626655dea5c187e7d6ca9e81352f288a61ff71755d3814369ae887df6cb279edf589cfcf0582bd229796fab90aac014d896efb45fe101e2e41b46530a8113c36fa270c15c8ebc0173fc37ddcc8ffcfc2b8d9ad32543093734ea7b2e2ee18a2ac21788c82976ad4ea2746ae43db0287866543a32b51ca414e65d285e7a6a112bc1b361fd8ef0c3bfffa42e8be4d230f5e1aa6ac97e04c64b6ed2dce052c236cb96987b78c32490d8d818ddb7f02a15f663a811911fc002ab79c671671f585c0848049ba5f2810d686cf26feb3dd1aa9cfb22287df53a0a484251d0e4cda3010a29b1ed3110c9cb7144b6e3d389e0c993fcfb023cc2257cd85b7b6674ffe6dc897ef962f4877e5395f8d44f49cc44c431e70f8818e41cd5a6c27a1afa4211959e816b4c106e7cc7d096462d279033bb8b7a89155c7155047cc8cdc02996c3bc5cc280283541bf52b683ee3854f386f545f504f02f1b6a94527e8b90ad9ccd960da2219477fa760f630406598ee99d7257003b1ec64f154190cc643847e5234df914694830d2545ebe0ba1d4ae2522e1b942f82515c864c2b70b3d54d74e3be7bd9cadc5560641d7b0fa5e68a1c8a990df187ccde8711acb623c200a5de011b4f730e870eca4ab50316f319bc4a0fa8703e82ef91b16ebfd8193f15df68d0699bd34f8c4ef84f761a932922a8e5b61c2d4c6db04d50efe0b682ba15f84db73ce3346c98f81b5f57b25cbcd50c684595327102c1d9c859eee9d20faf0d70b9b23234f811ea6c18a416967b735cd81ce433137b0a7f0b5a33728b0d8bbd97df83d60f0ab4c24ee5d3a13e1567d0120f2a882d489671929bfdc1aa1a07ca84a635213944fd7f9ca36b9baa936f2da283866c99210ec3f2de7278f8d6160e99f2d797866be59226180c10e9bdba3f7d862e1597a6f43c28a2e75142f7ee039d8827d1c574db2092f755fb93d8d53e602bc3b29a52d86e995427278a1cf57215bf4f0efda18e0dafeba3dc66b53e18dcdd25a71ce113bd71e1eff113a89f4e08c8d8fde1ac43eefe52caae327b608975a801d29930a69be8e1b8189a4fe5bc3f119594c4d9cea10eac7cefa5b9e07a7cd59c0eb90acb5d603912e72ad4f73ae777ffaa4181a2dbe7207412f3dbc381bcd4da5ffe7769c5c844d5f987043945eb903cae1b3a3cdadbd30aff1f53067ca070633639b19356d73e93b7903d73fc6e25770c569377243c1d621aace2711dd52af79446b1e1d7bab6f1bf2fea5aa1032c60014755cbd4de67e59d3fad3ab1c597cdc0f460777876ddb820e5a7e2346bd01479d18c4ff5e074625a32b23452d1b8238bd3d2dbc45fe5df718bf06f7fcbfa01e1b1bd91872f238ac6960d3fd92b06a31f262a1cd0708d187f7c0a9c64f439ac7d307daa8a580ab5a9332d36a3ef6d6507ff999ddeb73af6292f7198630cb749c8895e422036eb6ca5a8794184d0c288c78afd0ca78c6033eb235c1d8ab7bd6361de0cc4596539680d1b86b876626ae54f68045fa2f370c10d69fda839f83982e1474b653d3a4874c7a9b28c848e58eef221741d5574716327e4cbc4e24886cade79b2021a20038b4df501e7316da8ace07d1e96c9433cbb648aa38bbe6c3cca4fa3bcb20beb704cd9bb9c3cf5e0283334d7636fbfa12b1b6da6a2e0d3d3f3e6b9b589d4e362beb4f6cb8c82641b77b2b311d58f2ba07f06c4708c8c98cc2c481537d14c53b1c29665222214728aa24fc1da5c6ee6a7208650b0d37e527950af36378dd89a1dd4a1da7a3a18781ef290335c06ce9671be086be05ac5736f21d7fb4d03353dd2af03c55141d4ccfe63c2685e584236db42b1d04f44954c3f333667dc119ef9868e0ad240b565c52f99bf841c0ec3039b8359db058ddd8b8fbd74</cipher-text><style type="text/css">div#hugo-encrypt-sha1sum{display:none}</style><script>const storageKey=location.pathname+"password",userStorage=window.sessionStorage;function str2buf(e){return new TextEncoder("utf-8").encode(e)}function buf2str(e){return new TextDecoder("utf-8").decode(e)}function hex2buf(e){return new Uint8Array(e.match(/.{2}/g).map(e=>parseInt(e,16)))}function deriveKey(e,t){return t=t||crypto.getRandomValues(new Uint8Array(8)),crypto.subtle.importKey("raw",str2buf(e),"PBKDF2",!1,["deriveKey"]).then(e=>crypto.subtle.deriveKey({name:"PBKDF2",salt:t,iterations:1e3,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])).then(e=>[e,t])}function decrypt(e,t){const[n,s,o]=t.split("-").map(hex2buf);return deriveKey(e,n).then(([e])=>crypto.subtle.decrypt({name:"AES-GCM",iv:s},e,o)).then(e=>buf2str(new Uint8Array(e)))}async function digestMessage(e){const t=(new TextEncoder).encode(e),n=await crypto.subtle.digest("SHA-1",t),s=Array.from(new Uint8Array(n)),o=s.map(e=>e.toString(16).padStart(2,"0")).join("");return o}const hugoDecrypt=function(e,t){for(const n of ciphers)decrypt(e,n.innerText).then(function(t){digestMessage(t.replace(/\r?\n?[^\r\n]*$/,"")).then(function(s){t.includes(s)&&(document.getElementById("hugo-encrypt-encryption-notice").remove(),n.outerHTML=t,userStorage.setItem(storageKey,e),document.getElementById("hugo-encrypt-sha1sum").innerHTML="Success: "+s,console.log("Decryption successful. Storing password in sessionStorage."))})}).catch(function(e){t==="input"?(document.getElementById("hugo-encrypt-input-response").innerHTML="密码错误！",console.log("密码错误！",e)):t==="storage"&&(userStorage.removeItem(location.pathname+"password"),console.log("Password changed. Clearing userStorage.",e))})}</script><script>window.onload=()=>{ciphers=Array.from(document.querySelectorAll("cipher-text")),userStorage.getItem(storageKey)&&(console.log("Found storageKey in userStorage. Attemtping decryption"),hugoDecrypt(userStorage.getItem(storageKey),"storage"))}</script></hugo-encrypt><h2 id="未被加密的标题">未被加密的标题
<a href="#%e6%9c%aa%e8%a2%ab%e5%8a%a0%e5%af%86%e7%9a%84%e6%a0%87%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h2><p>在解密前这里的序号是1.1，解密后这里的序号是3.4.</p><h1 id="未被加密的一级标题">未被加密的一级标题
<a href="#%e6%9c%aa%e8%a2%ab%e5%8a%a0%e5%af%86%e7%9a%84%e4%b8%80%e7%ba%a7%e6%a0%87%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h1><p>在解密前这里的序号是2，解密后这里的序号是4.</p><h2 id="未解决的问题">未解决的问题
<a href="#%e6%9c%aa%e8%a7%a3%e5%86%b3%e7%9a%84%e9%97%ae%e9%a2%98"><small data-pagefind-ignore="">¶</small></a></h2><ol><li>目录会出现问题. 可能是 css 标签被改了的原因，具体没有仔细看，也不着急解决这个问题.</li><li>本地测试时把加密内容直接隐藏了，以至于只能先把文章写完再进行加密操作. 有个解决思路是用 <code>{{ if not .Site.IsServer }} {{ end }}</code> 在 <code>layouts/shortcodes/hugo-encryptor.html</code> 里做一下限制，不过试了一下不太会写，留待以后愿意解决再解决吧.</li><li><del>那个 <code>&lt;!-- more --&gt;</code> 的标签导致它上面的内容成为了 summary，而 front matter 里的 summary 不再起作用. 这倒不是什么大问题.</del></li><li>如果有两段加密内容的话，页面里有些 js 可能会重复，可以考虑精简精简. 还有就是“密码错误”的弹出位置可能不对，输入第二个密码却弹在第一个.（见英文页面）</li><li>阅读并理解代码，确定它的可靠性.（做那个 sha 之类的.）确定它没有从网络上获取什么 js.</li><li>弄得好看一点？</li></ol><p></p><p></p><p></p><p></p></article></div><div data-pagefind-ignore="" class="right_comments"><script src="https://utteranc.es/client.js" repo="zerovip/bcsu" issue-term="pathname" theme="github-light" crossorigin="anonymous" async=""></script></div></div><aside data-pagefind-ignore="" class="toc" id="toc"><button class="toc_title">目录</button><div class="toc_content"><nav id="TableOfContents"><ul><li><a href="#介绍">介绍</a><ul><li><a href="#未被加密的标题">未被加密的标题</a></li></ul></li><li><a href="#未被加密的一级标题">未被加密的一级标题</a><ul><li><a href="#未解决的问题">未解决的问题</a></li></ul></li></ul></nav></div></aside></div><template id="search-zone-template"><div id="search-zone"><div class="search_bar"><input type="search" id="search-input-box" class="search_bar_search-box" placeholder="搜索……" autocomplete="off"/><div class="search_bar_close-sign" onclick="closeSearch(this)"><div class="close-sign"></div></div></div><div class="search_results"></div></div></template><template id="search-result"><div class="search_results_item"><div class="search_results_item_title"></div><div class="search_results_item_content"></div><div class="search_results_item_tags"><div class="search_results_item_tags_date"></div><div class="search_results_item_tags_sections"></div></div></div></template><script src="../../js/main.07644855453ea3563fc25b36d91f32b4aa952cd60ebafb6fad77cf9c74baea47.js"></script></body></html>