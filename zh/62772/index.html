<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta content="width=divice-width, initial-scale=1.0" name="viewport"/>
<meta content="Hugo 0.62.0" name="generator"/>
<title>
        
    静态博客文章加密工具测试
 | 赤赤的象牙塔
    </title>
<link href="../../css/base.css" rel="stylesheet" type="text/css"/>
<link href="../../css/small.css" media="screen and (max-width: 1200px)" rel="stylesheet" type="text/css"/>
<link href="../../css/normal.css" media="screen and (min-width: 1201px)" rel="stylesheet" type="text/css"/>
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-143006759-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<script>
        function ChangeClassLeft(){
            document.getElementById("left").classList.toggle("left_show");
            }
        function ChangeClassTOC(){
            document.getElementById("toc").classList.toggle("toc_show");
            }
    </script>
</head>
<body>
<div class="bar_for_phone">
<div class="bar_left_button">
<button class="left_button_for_bar" onclick="ChangeClassLeft()">●●●</button>
</div>
<div class="bar_title">
<a href="../../zh/">赤赤的象牙塔</a>
</div>
<div class="bar_right_button">
<button class="toc_title_for_bar" onclick="ChangeClassTOC()">目录</button>
</div>
</div>
<div class="body_for_pc">
<div class="left" id="left">
<div class="left_non-footer">
<div class="left_non-footer_option">
<li><a href="https://zerovip.github.io/zh/62772/index.xml">RSS 订阅<img src="../../images/rss.png"/></a></li>
<li><br/></li>
<li><a href="https://zerovip.github.io/zh/62772/">简体中文●</a></li>
<li><a href="https://zerovip.github.io/en/62772/">English●</a></li>
<li><a href="https://zerovip.github.io/fr/62772/">Français●</a></li>
</div>
<div class="left_non-footer_head">
<div class="left_non-footer_head_title"><a href="../../zh/">赤赤的象牙塔</a></div>
<div class="left_non-footer_head_subtitle">(●’◡’●)ﾉ</div>
</div>
<div class="left_non-footer_main">
<div class="h1">
<a href="../../zh/math/">数学</a>
</div>
<div class="h2">
<a href="../../zh/math/notes/">数学笔记 </a>
</div>
<div class="h2">
<a href="../../zh/math/stories/">数学科普 </a>
</div>
<div class="h1 active">
<a href="../../zh/non-math/">非数学</a>
</div>
<div class="h2">
<a href="../../zh/non-math/journal/">日志 </a>
</div>
<div class="h2">
<a href="../../zh/non-math/literature/">写作 </a>
</div>
<div class="h2 active">
<a href="../../zh/non-math/memos/">备忘 </a>
</div>
<div class="h1">
<a href="../../zh/about/">关于</a>
</div>
<div class="h2">
<a href="../../zh/about/me/">关于我 </a>
</div>
<div class="h2">
<a href="../../zh/about/site/">关于本站 </a>
</div>
</div>
</div>
<div class="left_footer">
<div class="copyright">©2019-2020 版权所有.</div>
</div>
</div>
<div class="right">
<div class="right_head">
<div class="right_head_title">
            静态博客文章加密工具测试
        </div>
<div class="right_head_des">
            2019-12-23 - 767 字
        </div>
</div>
<div class="right_main">
<div class="right_main_article">
<p>一次测试.（这里是 summary 的内容.）</p>
<h1 id="heading">介绍</h1>
<p><a href="https://github.com/Li4n0/hugo_encryptor">Hugo encryptor</a> 是一款我偶然发现的可以给静态博客文章进行加密的小工具，配置使用很简单，可惜的是不能在本地测试.</p>
<p>不过它足够简单，一经测试成功可以投入使用便不再需要反复测试，因此这篇博文是专门用来测试的.</p>
<p>下面加密内容的密码是【PASS3word】.</p>
<hugo-encryptor>
<p>以下内容被密码保护</p>
<div class="hugo-encryptor-form">
<input class="hugo-encryptor-input" id="hugo-encryptor-password" placeholder="请输入密码"/>
<input class="hugo-encryptor-button" onclick="hugoDecrypt(CryptoJS.MD5(document.getElementById('hugo-encryptor-password').value).toString(),'input')" type="button" value="提交"/>
</div>
<cipher-text style="display:none;">eknMpJavDcGyIr7rL0O+sl8YsxauWb1yMEzPYejDh1itha/mdlUu3liPWUF1Fq53rPA/z/0eJPFXShGq/CXG+/+meyTB/HaGYTzZkaUBrlDzqeiagv1YShri0uDsekK84EK5kl8FAFa23QzxI9RFtT8cgUPzTrGlIw06NxBVyqe02Or5h4WIN33hZD5oShbqPVXXqi8EqtuPkXkyk7TChvC1aK8tzRUd/GTvzw3tgKnSkxS9H0ZkE/ZbLV/FeRH/joIyAcNqhUqhpGJUpH93SPUpON3NFVizoePM1jnHKdKDg5H3nU11F9bQc9wIzW4yQGlefdLtjBb8ROIJgRDrbSImpHJ3kS6ArxSdKYCBzsLOB88ZM10oEBll84BYavbGCksQ8WDPWg+vwe/Ky001NgJ5LhE+DgnDsErSCZ2JW5XC1omX/94NockaJCDKZurFDNPNxZGRpGulyrXqmd0e7SG4JFHdybEWuinpBpNhkCKECEoEiiXAXe9Kel28PiK3nY+9n8w7rWtSg04QkEl99gsdbvnmNvo05unD/+dmiHr+tz68/SVWHEgOt7q4uQYBuqQHEYSXZvTC7YP7aA7xUAvMLIhKCnQuoadce0qAZ2ao37Edgt9KAe/r3WXtjb9gJfBmzrzPam9XOONCMRJMdnI/Ym1q+fAEIpqRmvnuHxGkrgAUpXgjIRmdlhAv7Q+4Ls8wbpgLEA/GdJqJIF/8C+DvxTJBUU40WBqi7MCGTBBVGk+xD68OaFwED00GnO5HhNyRAf9+S0QLouAVNPuusVGTUE2Amy9z7EDrkJJtLJF9h5qn9hnjshY4NcSax+JEI/0tul/ETqjXckHMY0fq0HHWruArPDE0MdfpfZFmaTUi1TpAetnszfpEBPC4e95+95UJRBAkd76csbCHKyUwAZSJCJrCr9GkuQDHmQYx7s4eZOkSXhNNsrkku4aCKVcswmXy/cGy18EdEtjQLF2ueZ9S7C9jODELbtniBcnlew9i72V15lV7Ut1HhwsR/Lt6t/JE1ddrJG5Kcsl1KFnxqwsrMBWLs5PT3sylQ7pGLuKjpEFCfsFGvw46DaX2ANqioKk4+IL2Psp2Y/IC3jl6B+0MbWwmKDE/bCBjw2+0Y+aM7FJR92+HdqThk17CEXetlB4bAMnbNKRyIBBQF9NqRnUPzvJHjtbBLIwxPMmwyEC2YFQL/59FFebCA+aACfi7cAdco9CvwAYtqr6AsDsdt2Sy9qr71oHeb3BCA7gQRhhRxqUjOR8hZUjLSrQbjzXr</cipher-text>
<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.js"></script>
<script>
      let cipher = document.getElementsByTagName("cipher-text")[0];
      const storageKey = location.pathname + "password";
      const userStorage =  window['sessionStorage'] ;
      

      const decrypt = function(cipher_text, password) {
        let key = CryptoJS.enc.Utf8.parse(password);
        let iv = CryptoJS.enc.Utf8.parse(password.substr(16));

        let decryptedData = CryptoJS.AES.decrypt(cipher_text, key, {
          iv: iv,
          mode: CryptoJS.mode.CBC,
          padding: CryptoJS.pad.Pkcs7
        });
        return decryptedData.toString(CryptoJS.enc.Utf8);
      };
      

      const hugoDecrypt = function(password, type) {
        try {
          let cipher_text = cipher.innerText;
          let decrypted_text = decrypt(cipher_text, password);
          if (
            decrypted_text.includes("The quick brown fox jumps over the lazy dog")
          ) {
            cipher.parentElement.outerHTML = decrypted_text;
            userStorage.setItem(storageKey, password);
            document.getElementById("verifyText").outerHTML = "";
          } else {
            if (type === "input") {
              alert('密码错误');
            } else if (type === "storage") {
              userStorage.removeItem(storageKey);
            }
          }
        } catch (error) {
          
          if (type === "input") {
            alert('密码错误');
          } else if (type === "storage") {
            userStorage.removeItem(location.pathname + "password");
          }
        }
      };
  </script>
<script>
    window.onload = () => {
      if (userStorage.getItem(storageKey)) {
        hugoDecrypt(userStorage.getItem(storageKey), "storage");
      }
    };
  </script>
</hugo-encryptor>
<h2 id="heading-1">未被加密的标题</h2>
<p>在解密前这里的序号是1.1，解密后这里的序号是3.4.</p>
<h1 id="heading-2">未被加密的一级标题</h1>
<p>在解密前这里的序号是2，解密后这里的序号是4.</p>
<h2 id="heading-3">未解决的问题</h2>
<ol>
<li>目录会出现问题. 可能是 css 标签被改了的原因，具体没有仔细看，也不着急解决这个问题.</li>
<li>本地测试时把加密内容直接隐藏了，以至于只能先把文章写完再进行加密操作. 有个解决思路是用 <code>{{ if not .Site.IsServer }} {{ end }}</code> 在 <code>layouts/shortcodes/hugo-encryptor.html</code> 里做一下限制，不过试了一下不太会写，留待以后愿意解决再解决吧.</li>
<li>那个 <code>&lt;!--more--&gt;</code> 的标签导致它上面的内容成为了 summary，而 front matter 里的 summary 不再起作用. 这倒不是什么大问题.</li>
</ol>
</div>
<div class="right_main_notes">
</div>
</div>
<div class="right_comments">
<script async="" crossorigin="anonymous" issue-term="pathname" repo="zerovip/bcsu" src="https://utteranc.es/client.js" theme="github-light">
</script>
</div>
</div>
<div class="toc" id="toc">
<button class="toc_title">目录</button>
<div class="toc_content">
<nav id="TableOfContents">
<ul>
<li><a href="#heading">介绍</a>
<ul>
<li><a href="#heading-1">未被加密的标题</a></li>
</ul>
</li>
<li><a href="#heading-2">未被加密的一级标题</a>
<ul>
<li><a href="#heading-3">未解决的问题</a></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
</body>
</html>
